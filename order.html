<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8">
        <title>fairycakes</title>
        <link rel="stylesheet" href="css/style.css">
        <link rel="shortcut icon" href="icon.ico">
    </head>

    <body>
        <div id="wrapper">
            <div class="header">
                <img src="fairycakesheader.png" height="350">
            </div>
            <div class="content">
                <hr>
                <div class="info">
                    <form action="index.html">
                        <button>На главную</button>
                    </form>
                </div>
                <hr>
                <div class="order">
                    <form name="order_form" id="order_form">
                    <div class="kg">
                        <h1>Вес/Размер:</h1>
                        <input type="radio" id="kg1" name="kg_button" value="0.5kg" checked onclick="setkg(this);">
                        <label for="kg1" >0.5 кг / 600 руб</label>
                        <input type="radio" id="kg2" name="kg_button" value="1kg" checked onclick="setkg(this);">
                        <label for="kg2">1 кг / 1200 руб</label>
                        <input type="radio" id="kg3" name="kg_button" value="1.5kg" checked onclick="setkg(this);">
                        <label for="kg3">1.5 кг / 1800 руб</label>
                        <input type="radio" id="kg4" name="kg_button" value="2kg" checked onclick="setkg(this);">
                        <label for="kg4">2 кг / 2200 руб</label>
                    </div>
                    <hr>
                    <div class="filling">
                        <h1>Начинка:</h1>
                        <div class="img_filling_div">
                            <img src="https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/filling.png?raw=true" id="img_filling">
                        </div>
                        <select id="select_filling" required="required" onchange="getval(this);" name="select_filling">
                            <option value="filling0">Выбрать начинку</option>
                            <option value="filling1">Сникерс / 400 Руб</option>
                            <option value="filling2">Орео / 200 Руб</option>
                            <option value="filling3">Шоколад / бесплатно</option>
                            <option value="filling4">Черника-ваниль / 200 Руб</option>
                            <option value="filling5">Красный бархат / 200 Руб</option>
                            <option value="filling6">Морковь-грецкий орех / 200 Руб</option>
                            <option value="filling7">Пломбир / бесплатно</option>
                            <option value="filling8">Шоколад-малина-орех / 200 Руб</option>
                            <option value="filling9">Малина-фисташка / 400 Руб</option>
                            <option value="filling10">Радуга / 400 Руб</option>
                          </select>
                    </div>
                    <hr>
                    <div class="delivery">
                        <div class="input-button">
                            <button onmousedown="viewDiv1()">Самовывоз</button>
                            <button onmousedown="viewDiv2()">Доставка</button>
                        </div>
                    </div>
                    <div id="div2">
                        <h1 id="white">Доставка по г. Домодедово - 200 руб</h1>
                        <br>
                        <h1 id="white">Ваш адрес:</h1>
                        <input type="text" name="address">
                    </div>
                    <div id="div1">
                        <!-- <h1 id="white">Адрес: г. Домодедово, бла бла, д. блабла</h1> -->
                        <div class="map-responsive">
                            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2262.695305836066!2d37.744674339265494!3d55.450544593797545!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x414aa5cd7150d777%3A0xa8de3041240d2f94!2z0J7Qu9C40LzQv9C40LnRgdC60LjQuSDRgdC60LLQtdGA!5e0!3m2!1sru!2sru!4v1670695361952!5m2!1sru!2sru" width="800" height="600" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                        </div>
                    </div>
                    <hr>
                    <div class="contacts">
                        <h1>Ваше имя:</h1>
                        <input type="text" id="yellow" required name="user_name">
                        <h1>Ваш телефон:</h1>
                        <input type="tel" id="yellow" required name="user_phone">
                    </div>
                    <div class="wish">
                        <h1>Ваши пожелания:</h1>
                        <textarea type="text" name="user_wish"></textarea>
                    </div>
                    <input type="submit" id="result" value="Заказать (0 Руб)" onclick="set(this);" name="result">
                    </form>
                </div>
            </div>
            <div class="footer"> </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script>
        <script>
            var images_store = {
                "filling0": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/filling.png?raw=true',
                "filling1": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/1.jpg?raw=true',
                "filling2": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/2.jpg?raw=true',
                "filling3": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/3.jpg?raw=true',
                "filling4": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/4.jpg?raw=true',
                "filling5": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/5.jpg?raw=true',
                "filling6": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/6.jpg?raw=true',
                "filling7": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/7.jpg?raw=true',
                "filling8": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/8.jpg?raw=true',
                "filling9": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/9.jpg?raw=true',
                "filling10": 'https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/filling_images/10.jpg?raw=true'
            }

            var counts = {
                "filling0": 0,
                "filling1": 400,
                "filling2": 200,
                "filling3": 0,
                "filling4": 200,
                "filling5": 200,
                "filling6": 200,
                "filling7": 0,
                "filling8": 200,
                "filling9": 400,
                "filling10": 400,
                "0.5kg": 600,
                "1kg": 1200,
                "1.5kg": 1800,
                "2kg": 2200
            }

            var fillings = {
                "filling0": 'Нет начинки',
                "filling1": 'Сникерс',
                "filling2": 'Орео',
                "filling3": 'Шоколад',
                "filling4": 'Черника-ваниль',
                "filling5": 'Красный бархат',
                "filling6": 'Морковь-грецкий орех',
                "filling7": 'Пломбир',
                "filling8": 'Шоколад-малина-орех',
                "filling9": 'Малина-фисташка',
                "filling10": 'Радуга'
            }

            var kgs = {
                "0.5kg": '500 грамм',
                "1kg": '1 килограмм',
                "1.5kg": '1.5 килограмма',
                "2kg": '2 килограмма'
            }

            var summakg = 0;
            var summafilling = 0;
            var summadelivery = 0;

            function set(sel){
                sel.setAttribute("value", "Заказать (" + (summakg + summafilling) + " Руб)");
            }

            function setkg(sel){
                summakg = counts[sel.value];
                document.getElementById("result").setAttribute("value", "Заказать (" + (summakg + summafilling + summadelivery) + " Руб)");
            }

            function getval(sel){
                document.getElementById("img_filling").src= images_store[sel.value];
                summafilling = counts[sel.value];
                document.getElementById("result").setAttribute("value", "Заказать (" + (summakg + summafilling + summadelivery) + " Руб)");
            }

            function viewDiv1(){
                document.getElementById("div1").style.display = "block";
                document.getElementById("div2").style.display = "none";
                summadelivery = 0;
                document.getElementById("result").setAttribute("value", "Заказать (" + (summakg + summafilling + summadelivery) + " Руб)");
            };

            function viewDiv2(){
                document.getElementById("div2").style.display = "block";
                document.getElementById("div1").style.display = "none";
                summadelivery = 200;
                document.getElementById("result").setAttribute("value", "Заказать (" + (summakg + summafilling + summadelivery) + " Руб)");
            };
            const TOKEN = "5524978177:AAGrWbaA-rda1AVHuUWXRSePemO8loW4n0A";
            const CHAT_ID = "-1001440617513";
            const URI_API = `https://api.telegram.org/bot${ TOKEN }/sendMessage`;

            document.getElementById('order_form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                let message = `<b>Новый заказ!</b>\n`;
                message += `👤 Имя: ${this.user_name.value}\n`;
                message += `📞 Телефон: <a href="tel:${this.user_phone.value}">${this.user_phone.value}</a>\n`;
                var address = this.address;
                if(address.value != ''){
                    message += `🗺 Адрес: ${address.value}\n`
                }
                message += `🎂 <b>Торт:</b>\n    - Размер: ${kgs[this.kg_button.value]}\n`;
                message += `    - Начинка: ${fillings[this.select_filling.value]}\n`
                message += `📝 Пожелания заказчика: ${this.user_wish.value}\n`;
                message += `💰 <b>Цена: </b>${(summakg + summafilling + summadelivery)} руб.`
                
                axios.post(URI_API, {
                    chat_id: CHAT_ID,
                    parse_mode: 'html',
                    text: message
                })
                .then((res) => {
                    location.href = "https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/thanks.html"
                })
                .catch((err) => {
                    location.href = "https://github.com/fairycakeskira/fairycakeskira.github.io/blob/main/error.html"
                });
            });
        </script>
    </body>
</html>